<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ঈদ মোবারক!</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Noto Sans', 'Arial', sans-serif;
            background: linear-gradient(to bottom, #001c00, #003800, #004d00);
            color: #f0e68c;
            text-align: center;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            line-height: 1.6;
        }
        body[lang="bn"] { font-family: 'Noto Sans Bengali', 'Arial', sans-serif; }
        body[lang="en"] { font-family: 'Roboto', 'Arial', sans-serif; }
        body[lang="ar"] { font-family: 'Noto Sans Arabic', 'Arial', sans-serif; direction: rtl; }
        body[lang="es"] { font-family: 'Noto Sans', 'Arial', sans-serif; }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        #fireworksCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        .container { background-color: rgba(1, 32, 1, 0.88); padding: 25px 20px; border-radius: 20px; box-shadow: 0 8px 25px rgba(255, 215, 0, 0.25); max-width: 500px; width: 90%; border: 2px solid #ffd700; position: relative; z-index: 1; margin-top: 3vh; margin-bottom: 3vh; }
        #eidVideo { width: 100%; max-height: 260px; object-fit: contain; border-radius: 15px; margin-bottom: 20px; border: 3px solid #ffd700; box-shadow: 0 0 12px rgba(255, 215, 0, 0.4); background-color: #001000; }
        .greeting-message { font-size: 2em; font-weight: 700; color: #fff; margin-bottom: 20px; text-shadow: 1px 1px 4px rgba(0,0,0,0.6); animation: fadeInGrow 1.5s cubic-bezier(0.25, 0.46, 0.45, 0.94); }
        @keyframes fadeInGrow { 0% { opacity: 0; transform: scale(0.7) translateY(25px); } 100% { opacity: 1; transform: scale(1) translateY(0); } }
        .input-group { margin-top: 25px; margin-bottom: 15px; }
        label { display: block; margin-bottom: 8px; color: #f0e68c; font-weight: bold; font-size: 1.05em; }
        body[lang="ar"] label { text-align: right; }
        input[type="text"] { width: 100%; padding: 12px; margin-bottom: 15px; border: 2px solid #ffd700; border-radius: 10px; font-size: 1em; background-color: #002a00; color: #fff; }
        body[lang="ar"] input[type="text"] { text-align: right; }
        input[type="text"]::placeholder { color: #b0a060; }
        button#generateButton { background-color: #25D366; color: #fff; padding: 12px 20px; border: none; border-radius: 10px; cursor: pointer; font-size: 1em; font-weight: bold; transition: background-color 0.2s ease, transform 0.15s ease, opacity 0.2s ease; letter-spacing: 0.5px; box-shadow: 0 3px 7px rgba(0,0,0,0.25); display: flex; align-items: center; justify-content: center; width: 100%; max-width: 280px; margin: 0 auto; }
        button#generateButton svg { width: 20px; height: 20px; margin-right: 8px; fill: #fff; }
        body[lang="ar"] button#generateButton svg { margin-left: 8px; margin-right: 0; }
        button#generateButton:disabled { background-color: #cccccc; color: #666666; cursor: not-allowed; opacity: 0.7; }
        button#generateButton:disabled svg { fill: #666666; }
        button#generateButton:not(:disabled):hover { background-color: #1DAE54; transform: translateY(-1px) scale(1.02); box-shadow: 0 5px 10px rgba(0,0,0,0.3); }
        button#generateButton:not(:disabled):active { transform: translateY(0px) scale(1); }
        #statusMessage { padding: 10px; margin-top: 10px; margin-bottom: 10px; border-radius: 8px; font-size: 0.9em; display: none; opacity: 0; transition: opacity 0.4s ease-in-out; }
        #statusMessage.success { background-color: #1DAE54; color: white; } #statusMessage.error { background-color: #d9534f; color: white; } #statusMessage.info { background-color: #5bc0de; color: white; }
        #generatedLinkContainer { margin-top: 15px; padding: 15px; background-color: rgba(0, 0, 0, 0.4); border-radius: 10px; border: 1px solid #DAA520; display: none; }
        body[lang="ar"] #generatedLinkContainer p { text-align: right; }
        #generatedLinkContainer p { color: #f0e68c; margin-bottom: 8px; font-size: 0.95em; }
        #sharableLink { width: calc(100% - 110px); padding: 10px; border: 1px solid #DAA520; border-radius: 8px; margin-right: 8px; background-color: #002a00; color: #fff; font-size: 0.95em;}
        body[lang="ar"] #sharableLink { margin-left: 8px; margin-right: 0; text-align: right; }
        button#copyButton { padding: 10px 15px; background-color: #B8860B; color: #fff; font-size: 0.95em; border: none; border-radius: 8px; cursor: pointer; transition: background-color 0.2s ease; }
        button#copyButton:hover { background-color: #DAA520; }
        footer { margin-top: 15px; font-size: 0.85em; color: #f0e68c; position: relative; z-index: 1; padding-bottom: 15px; }
        .dateTimeEntry { margin-top: 4px; font-size: 0.9em; } .dateTimeEntry span { margin: 0 3px; }

        /* --- বিজ্ঞাপনের Placeholder গুলোর জন্য CSS --- */
        .ad-placeholder {
            position: fixed;
            /* background-color: rgba(255, 0, 0, 0.1);  ডেভেলপমেন্টের সময় স্থান দেখতে সাহায্য করবে */
            /* border: 1px dashed red; */
            z-index: 5; /* কন্টেইনারের নিচে, কিন্তু ফায়ারওয়ার্কসের উপরে */
            overflow: hidden; /* যদি বিজ্ঞাপন প্লেসহোল্ডারের থেকে বড় হয় */
            display: flex; /* ভেতরের টেক্সট সেন্টারে আনার জন্য (ঐচ্ছিক) */
            align-items: center; /* ভেতরের টেক্সট সেন্টারে আনার জন্য (ঐচ্ছিক) */
            justify-content: center; /* ভেতরের টেক্সট সেন্টারে আনার জন্য (ঐচ্ছিক) */
            color: rgba(255,255,255,0.3); /* ভেতরের টেক্সটের রঙ (ঐচ্ছিক) */
            font-size: 0.8em; /* ভেতরের টেক্সটের আকার (ঐচ্ছিক) */
        }

        /* প্রতিটি প্লেসহোল্ডারের জন্য নির্দিষ্ট পজিশন ও আকার */
        /* এই আকারগুলো আপনার বিজ্ঞাপনের আকারের সাথে মিলিয়ে পরিবর্তন করতে হবে */
        #ad-left-top {
            top: 20px;
            left: 20px;
            width: 120px; /* উদাহরণ আকার */
            height: 240px;/* উদাহরণ আকার */
        }
        #ad-left-middle {
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            width: 160px; /* উদাহরণ আকার */
            height: 600px;/* উদাহরণ আকার */
        }
        #ad-bottom-left {
            bottom: 20px;
            left: 20px;
            width: 300px; /* উদাহরণ আকার */
            height: 50px; /* উদাহরণ আকার */
        }
        #ad-right-top {
            top: 20px;
            right: 20px;
            width: 120px; /* উদাহরণ আকার */
            height: 240px;/* উদাহরণ আকার */
        }
        #ad-right-middle {
            top: 50%;
            right: 20px;
            transform: translateY(-50%);
            width: 160px; /* উদাহরণ আকার */
            height: 600px;/* উদাহরণ আকার */
        }
        #ad-bottom-right {
            bottom: 20px;
            right: 20px;
            width: 300px; /* উদাহরণ আকার */
            height: 50px; /* উদাহরণ আকার */
        }

        /* মিডিয়া কোয়েরি: ছোট স্ক্রিনের জন্য বিজ্ঞাপন লুকাতে বা পজিশন পরিবর্তন করতে */
        @media (max-width: 1200px) { /* বড় ডেস্কটপের থেকে ছোট হলে */
            #ad-left-middle, #ad-right-middle {
                /* display: none; */ /* মাঝখানের লম্বা বিজ্ঞাপন লুকাতে পারেন */
                width: 120px; height: 400px; /* অথবা আকার ছোট করতে পারেন */
            }
        }
        @media (max-width: 992px) { /* ট্যাবলেটের মতো স্ক্রিনের জন্য */
            #ad-left-top, #ad-right-top,
            #ad-left-middle, #ad-right-middle,
            #ad-bottom-left, #ad-bottom-right {
                /* display: none; */ /* সব ফিক্সড বিজ্ঞাপন লুকাতে পারেন */
            }
             /* যদি উপরের গুলো দেখান, তাহলে আকার আরও ছোট করতে পারেন */
            #ad-left-top, #ad-right-top { width: 100px; height: 100px; }
            #ad-bottom-left, #ad-bottom-right { width: 200px; height: 50px; }
        }
        @media (max-width: 767px) { /* মোবাইলের জন্য */
            .ad-placeholder { /* সব ফিক্সড পজিশনের অ্যাড মোবাইল ভিউতে না দেখানোই ভালো */
                display: none !important;
            }
            /* আপনি চাইলে এখানে .container এর ভেতরে বা অন্য কোনো স্থানে মোবাইলের জন্য আলাদা অ্যাড প্লেসমেন্ট তৈরি করতে পারেন */
            /* .mobile-ad-bottom { display: block; width: 90%; margin: 10px auto; height: 50px; background-color: #333; } */
        }


        @media (max-width: 480px) { .container { padding: 20px 15px; margin-top: 2vh; margin-bottom: 2vh; } #eidVideo { max-height: 220px; margin-bottom: 15px; } .greeting-message { font-size: 1.7em; margin-bottom: 15px; } label { font-size: 1em; } input[type="text"] { padding: 10px; font-size: 0.95em; } button#generateButton { padding: 10px 15px; font-size: 0.95em; max-width: 250px; } button#generateButton svg { width: 18px; height: 18px; } #statusMessage { font-size: 0.85em; } #sharableLink, button#copyButton { font-size: 0.9em; } footer { font-size: 0.8em; } .dateTimeEntry { font-size: 0.85em; } }
        @media (max-width: 360px) { .greeting-message { font-size: 1.5em; } #eidVideo { max-height: 180px; } }
    </style>
</head>
<body lang="bn">
    <canvas id="fireworksCanvas"></canvas>
    <audio id="backgroundMusic" src="eidmubarak.mp3" loop preload="metadata"></audio>

    <!-- বিজ্ঞাপনের Placeholder গুলো -->
    <div id="ad-left-top" class="ad-placeholder">
        <!-- Ad Left Top: এখানে আপনার অ্যাড নেটওয়ার্কের কোড বসবে -->
        (Ad LT) <!-- ডেভেলপমেন্টের জন্য টেক্সট -->
    </div>
    <div id="ad-left-middle" class="ad-placeholder">
        <!-- Ad Left Middle: এখানে আপনার অ্যাড নেটওয়ার্কের কোড বসবে -->
        (Ad LM) <!-- ডেভেলপমেন্টের জন্য টেক্সট -->
    </div>
    <div id="ad-bottom-left" class="ad-placeholder">
        <!-- Ad Bottom Left: এখানে আপনার অ্যাড নেটওয়ার্কের কোড বসবে -->
        (Ad BL) <!-- ডেভেলপমেন্টের জন্য টেক্সট -->
    </div>

    <div id="ad-right-top" class="ad-placeholder">
        <!-- Ad Right Top: এখানে আপনার অ্যাড নেটওয়ার্কের কোড বসবে -->
        (Ad RT) <!-- ডেভেলপমেন্টের জন্য টেক্সট -->
    </div>
    <div id="ad-right-middle" class="ad-placeholder">
        <!-- Ad Right Middle: এখানে আপনার অ্যাড নেটওয়ার্কের কোড বসবে -->
        (Ad RM) <!-- ডেভেলপমেন্টের জন্য টেক্সট -->
    </div>
    <div id="ad-bottom-right" class="ad-placeholder">
        <!-- Ad Bottom Right: এখানে আপনার অ্যাড নেটওয়ার্কের কোড বসবে -->
        (Ad BR) <!-- ডেভেলপমেন্টের জন্য টেক্সট -->
    </div>
    <!-- আপনি চাইলে মোবাইলের জন্য আলাদা প্লেসমেন্ট এখানে বা .container এর ভেতরে যোগ করতে পারেন -->
    <!-- <div class="mobile-ad-bottom ad-placeholder"> (Mobile Ad) </div> -->


    <div class="container">
        <div id="greetingMessage" class="greeting-message"></div>
        <video id="eidVideo" src="eidmubarak.mp4" autoplay loop muted playsinline preload="metadata">
            Your browser does not support the video tag.
        </video>
        <div class="input-group">
            <label for="userNameInput" data-lang-key="yourNameLabel">আপনার নাম লিখুন:</label>
            <input type="text" id="userNameInput" data-lang-key="namePlaceholder" placeholder="এখানে আপনার নাম দিন">
            <button id="generateButton" onclick="generateAndShareLink()" disabled>
                <svg viewBox="0 0 24 24"><path d="M12.04 2C6.58 2 2.13 6.45 2.13 11.91C2.13 13.66 2.61 15.31 3.4 16.78L2 22L7.31 20.62C8.72 21.37 10.33 21.82 12.04 21.82C17.5 21.82 21.95 17.37 21.95 11.91C21.95 6.45 17.5 2 12.04 2M12.04 19.96C10.6 19.96 9.22 19.57 8.03 18.89L7.62 18.65L4.32 19.53L5.22 16.32L4.96 15.89C4.14 14.57 3.74 13.07 3.74 11.91C3.74 7.36 7.48 3.62 12.04 3.62C16.6 3.62 20.34 7.36 20.34 11.91C20.34 16.47 16.6 19.96 12.04 19.96M17.01 14.34C16.76 14.22 15.56 13.64 15.34 13.56C15.13 13.48 14.97 13.44 14.82 13.67C14.67 13.91 14.17 14.51 14.03 14.67C13.88 14.82 13.73 14.84 13.48 14.72C13.24 14.6 12.26 14.27 11.11 13.24C10.21 12.43 9.62 11.47 9.44 11.18C9.27 10.89 9.41 10.76 9.53 10.64C9.64 10.53 9.78 10.34 9.91 10.19C10.03 10.04 10.07 9.93 10.15 9.76C10.23 9.59 10.19 9.45 10.11 9.33C10.04 9.22 9.46 7.78 9.22 7.23C8.99 6.68 8.76 6.72 8.59 6.72H8.24C8.06 6.72 7.78 6.8 7.54 7.04C7.3 7.28 6.67 7.85 6.67 8.99C6.67 10.13 7.58 11.21 7.7 11.37C7.82 11.53 9.32 13.83 11.59 14.73C12.14 14.96 12.58 15.09 12.95 15.19C13.48 15.32 14.25 15.25 14.58 14.94C14.96 14.58 15.34 14.04 15.49 13.81C15.65 13.59 15.57 13.48 15.5 13.38C15.42 13.28 15.2 13.2 14.95 13.08C14.7 12.96 17.25 14.46 17.01 14.34Z"/></svg>
                <span data-lang-key="shareButtonText">WhatsApp এ শেয়ার করুন</span>
            </button>
            <div id="statusMessage"></div>
        </div>
        <div id="generatedLinkContainer">
            <p data-lang-key="shareLinkManualText">এই লিঙ্কটি বন্ধুদের সাথে শেয়ার করুন (যদি অটো-শেয়ার কাজ না করে):</p>
            <input type="text" id="sharableLink" readonly>
            <button id="copyButton" onclick="copyLink()" data-lang-key="copyButtonText">কপি করুন</button>
        </div>
    </div>
    <footer>
        <p data-lang-key="eidWishesFooter">সবাইকে ঈদের আন্তরিক শুভেচ্ছা!</p>
        <div id="dateTimeDisplay">
            <div class="dateTimeEntry">
                <span id="currentTime"></span> | <span id="currentDate"></span>
            </div>
            <div class="dateTimeEntry">
                <span id="currentHijriDate" data-lang-key="hijriDateLoading">ইসলামী তারিখ পরীক্ষা করা হচ্ছে...</span>
            </div>
        </div>
    </footer>

    <script>
    // --- HijriDate Library (Standard Version) ---
    (function(global) {
        var HijriDate = {};
        var floor = Math.floor;
        var replace = function(template, data) {
            return template.replace(/\{([\w\.]*)\}/g, function(str, key) {
                var keys = key.split("."), v = data[keys.shift()];
                for (var i = 0, l = keys.length; i < l; i++) v = v[keys[i]];
                return (typeof v !== "undefined" && v !== null) ? v : "";
            });
        };
        var monthDays = [30, 29, 30, 29, 30, 29, 30, 29, 30, 29, 30, 29];
        var monthNames = ["Muharram", "Safar", "Rabi'ul Awwal", "Rabi'ul Akhir", "Jamadil Awwal", "Jamadil Akhir", "Rajab", "Sha'ban", "Ramadhan", "Shawwal", "Dhul Qa'ada", "Dhul Hijja"];
        var dayNames = ["Ahad", "Ithnin", "Thulatha", "Arbia'a", "Khamees", "Jomu'a", "Sabt"];
        var gLIMIT = 227015;
        var _HijriDate = function(year, month, date, hour, minute, second, millisecond) {
            if (year instanceof Date) {
                var gdate = year;
                var gYear = gdate.getFullYear(), gMonth = gdate.getMonth(), gDate = gdate.getDate();
                var julianDayNumber = floor((1461 * (gYear + 4800 + floor((gMonth - 14) / 12))) / 4) + floor((367 * (gMonth - 2 - 12 * (floor((gMonth - 14) / 12)))) / 12) - floor((3 * floor((gYear + 4900 + floor((gMonth - 14) / 12)) / 100)) / 4) + gDate - 32075;
                var l = julianDayNumber - 1948440 + 10632;
                var n = floor((l - 1) / 10631);
                l = l - 10631 * n + 354;
                var j = (floor((10985 - l) / 5316)) * (floor((50 * l) / 17719)) + (floor(l / 5670)) * (floor((43 * l) / 15238));
                l = l - (floor((30 - j) / 15)) * (floor((17719 * j) / 50)) - (floor(j / 16)) * (floor((15238 * j) / 43)) + 29;
                month = floor((24 * l) / 709); date = l - floor((709 * month) / 24); year = 30 * n + j - 30;
                this._date = date; this._month = month; this._year = year;
                this._hour = gdate.getHours(); this._minute = gdate.getMinutes(); this._second = gdate.getSeconds(); this._millisecond = gdate.getMilliseconds();
                var tempGDate = this.toGlobalDate(); this._day = tempGDate.getDay();
                return this;
            }
            this._date = date; this._month = month; this._year = year;
            this._hour = hour || 0; this._minute = minute || 0; this._second = second || 0; this._millisecond = millisecond || 0;
            var gdateInstance = this.toGlobalDate(); this._day = gdateInstance.getDay();
            return this;
        };
        _HijriDate.prototype.getFullYear = function() { return this._year; }; _HijriDate.prototype.getMonth = function() { return this._month; }; _HijriDate.prototype.getDate = function() { return this._date; }; _HijriDate.prototype.getHours = function() { return this._hour; }; _HijriDate.prototype.getMinutes = function() { return this._minute; }; _HijriDate.prototype.getSeconds = function() { return this._second; }; _HijriDate.prototype.getMilliseconds = function() { return this._millisecond; }; _HijriDate.prototype.getDay = function() { return this._day; };
        _HijriDate.prototype.toGlobalDate = function() {
            var y = this._year; var m = this._month; var d = this._date;
            var jd = floor((11 * y + 3) / 30) + 354 * y + 30 * m - floor((m - 1) / 2) + d + 1948440 - 386;
            var gYear, gMonth, gDate; var l,n,i,j;
            if (jd > 2299160) { l = jd + 68569; n = floor((4 * l) / 146097); l = l - floor((146097 * n + 3) / 4); i = floor((4000 * (l + 1)) / 1461001); l = l - floor((1461 * i) / 4) + 31; j = floor((80 * l) / 2447); gDate = l - floor((2447 * j) / 80); l = floor(j / 11); gMonth = j + 2 - 12 * l; gYear = 100 * (n - 49) + i + l; }
            else { j = jd + 1402; var k = floor((j - 1) / 1461); l = j - 1461 * k; n = floor((l - 1) / 365) - floor(l / 1461); i = l - 365 * n + 30; gDate = floor((80 * i) / 2447); gMonth = floor(gDate / 11) + i - floor((2447 * floor(gDate/11))/80) ; gYear = 4 * k + n + floor(gMonth/3) - 4716; gMonth = (gMonth + 1) % 13; if(gMonth === 0) gMonth = 1; }
            return new Date(gYear, gMonth - 1, gDate, this._hour, this._minute, this._second, this._millisecond);
        };
        _HijriDate.prototype.getMonthName = function() { return monthNames[this._month - 1]; }; _HijriDate.prototype.getDayName = function() { return dayNames[this._day]; };
        HijriDate.JS = { convert: function(gDate) { return new _HijriDate(gDate); }};
        if (typeof module !== "undefined" && module.exports) { module.exports = HijriDate; } else if (typeof define === "function" && define.amd) { define(HijriDate); } else { global.HijriDate = HijriDate; }
    }(this));
    </script>

    <script>
        // --- Main Application Logic ---
        const translations = {
            'bn': { 'pageTitle': 'ঈদ মোবারক!', 'greetingMessage': 'ঈদ মোবারক!', 'greetingMessageFrom': '{name} এর পক্ষ থেকে, ঈদ মোবারক!', 'yourNameLabel': 'আপনার নাম লিখুন:', 'namePlaceholder': 'এখানে আপনার নাম দিন', 'shareButtonText': 'WhatsApp এ শেয়ার করুন', 'shareLinkManualText': 'এই লিঙ্কটি বন্ধুদের সাথে শেয়ার করুন (যদি অটো-শেয়ার কাজ না করে):', 'copyButtonText': 'কপি করুন', 'eidWishesFooter': 'সবাইকে ঈদের আন্তরিক শুভেচ্ছা!', 'timeLabel': 'সময়', 'dateLabel': 'তারিখ', 'hijriDateLabel': 'ইসলামী তারিখ', 'hijriYearSuffix': 'হিজরি', 'statusEnterName': 'অনুগ্রহ করে আপনার নাম লিখুন।', 'statusShareOptions': 'শুভেচ্ছা শেয়ার করার জন্য অপশন দেখানো হয়েছে!', 'statusShareError': 'শেয়ার অপশন কাজ করেনি/বাতিল হয়েছে। লিঙ্ক কপি করুন।', 'statusNoAutoShare': 'আপনার ব্রাউজার অটো-শেয়ার সাপোর্ট করে না। লিঙ্ক কপি করুন।', 'statusLinkCopied': 'লিঙ্ক সফলভাবে কপি করা হয়েছে!', 'statusLinkCopiedFallback': 'লিঙ্ক কপি করা হয়েছে (ফলব্যাক)!', 'statusCopyError': 'দুঃখিত, লিঙ্ক কপি করা যায়নি। নিজে কপি করে নিন।', 'hijriDateLoading': 'ইসলামী তারিখ পরীক্ষা করা হচ্ছে...', 'hijriDateError': 'ইসলামী তারিখ রূপান্তরে ত্রুটি।','musicPlayError': 'মিউজিক প্লে করা যায়নি। ডিভাইস সাউন্ড চেক করুন।', },
            'en': { 'pageTitle': 'Eid Mubarak!', 'greetingMessage': 'Eid Mubarak!', 'greetingMessageFrom': 'Eid Mubarak from {name}!', 'yourNameLabel': 'Enter your name:', 'namePlaceholder': 'Enter your name here', 'shareButtonText': 'Share on WhatsApp', 'shareLinkManualText': 'Share this link with friends (if auto-share doesn\'t work):', 'copyButtonText': 'Copy', 'eidWishesFooter': 'Eid greetings to everyone!', 'timeLabel': 'Time', 'dateLabel': 'Date', 'hijriDateLabel': 'Islamic Date', 'hijriYearSuffix': 'AH', 'statusEnterName': 'Please enter your name.', 'statusLinkCopied': 'Link copied successfully!', 'hijriDateLoading': 'Checking Islamic date...', 'hijriDateError': 'Error in Islamic date conversion.','musicPlayError': 'Could not play music. Check device sound.', },
            'ar': { 'pageTitle': 'عيد مبارك!', 'greetingMessage': 'عيد مبارك!', 'greetingMessageFrom': 'عيد مبارك من {name}!', 'yourNameLabel': 'أدخل اسمك:', 'namePlaceholder': 'أدخل اسمك هنا', 'shareButtonText': 'شارك على WhatsApp', 'shareLinkManualText': 'شارك هذا الرابط مع الأصدقاء:', 'copyButtonText': 'نسخ', 'eidWishesFooter': 'تهاني العيد للجميع!', 'timeLabel': 'الوقت', 'dateLabel': 'التاريخ', 'hijriDateLabel': 'التاريخ الهجري', 'hijriYearSuffix': 'هـ', 'statusEnterName': 'الرجاء إدخال اسمك.', 'statusLinkCopied': 'تم نسخ الرابط بنجاح!', 'hijriDateLoading': 'جاري التحقق من التاريخ الهجري...', },
            'es': { 'pageTitle': '¡Eid Mubarak!', 'greetingMessage': '¡Eid Mubarak!', 'greetingMessageFrom': '¡Eid Mubarak de parte de {name}!', 'yourNameLabel': 'Introduce tu nombre:', 'namePlaceholder': 'Introduce tu nombre aquí', 'shareButtonText': 'Compartir en WhatsApp', 'copyButtonText': 'Copiar', 'eidWishesFooter': '¡Saludos de Eid para todos!', 'timeLabel': 'Hora', 'dateLabel': 'Fecha', 'hijriDateLabel': 'Fecha Islámica', 'hijriYearSuffix': 'H', },
        };
        const countryToLangMap = { 'SA': 'ar', 'AE': 'ar', 'EG': 'ar', 'BD': 'bn', 'IN': 'en', 'US': 'en', 'GB': 'en', 'ES': 'es', 'MX': 'es', };
        const langToLocaleMap = { 'bn': 'bn-BD', 'en': 'en-US', 'ar': 'ar-SA', 'es': 'es-ES', };
        const supportedLanguages = Object.keys(translations);
        let currentLang = 'bn'; let userTimeZone = 'Etc/UTC'; let userLocale = 'bn-BD';
        const backgroundMusic = document.getElementById('backgroundMusic'); const userNameInput = document.getElementById('userNameInput'); const generateButton = document.getElementById('generateButton'); const statusMessageDiv = document.getElementById('statusMessage'); let statusTimeout;
        const currentTimeEl = document.getElementById('currentTime'); const currentDateEl = document.getElementById('currentDate'); const currentHijriDateEl = document.getElementById('currentHijriDate'); const greetingMessageEl = document.getElementById('greetingMessage'); const eidVideoEl = document.getElementById('eidVideo');
        let timeOffset = 0; let musicPlayAttemptedOnInteraction = false;
        const hijriMonthsData = {
            'bn': ["মহররম", "সফর", "রবিউল আউয়াল", "রবিউস সানি", "জমাদিউল আউয়াল", "জমাদিউস সানি", "রজব", "শাবান", "রমজান", "শাওয়াল", "জ্বিলকদ", "জ্বিলহজ্জ"],
            'en': ["Muharram", "Safar", "Rabi' al-awwal", "Rabi' al-thani", "Jumada al-awwal", "Jumada al-thani", "Rajab", "Sha'ban", "Ramadan", "Shawwal", "Dhu al-Qi'dah", "Dhu al-Hijjah"],
            'ar': ["محرم", "صفر", "ربيع الأول", "ربيع الثاني", "جمادى الأولى", "جمادى الآخرة", "رجب", "شعبان", "رمضان", "شوال", "ذو القعدة", "ذو الحجة"],
            'es': ["Muharram", "Safar", "Rabi' al-awwal", "Rabi' al-thani", "Jumada al-awwal", "Jumada al-thani", "Rajab", "Sha'ban", "Ramadán", "Shawwal", "Dhu ul-Qi'dah", "Dhu ul-Hiyya"]
        };
        function getTranslation(key, params = {}) { let text = (translations[currentLang] && translations[currentLang][key]) || (translations['en'] && translations['en'][key]) || key; for (const param in params) { text = text.replace(`{${param}}`, params[param]); } return text; }
        function applyTranslations() { document.querySelectorAll('[data-lang-key]').forEach(element => { const key = element.getAttribute('data-lang-key'); if (element.tagName === 'INPUT' && element.hasAttribute('placeholder')) { element.placeholder = getTranslation(key); } else { element.textContent = getTranslation(key); } }); document.title = getTranslation('pageTitle'); }
        function toNativeNumeral(numStr, lang) { if (lang === 'bn') { const d = ['০', '১', '২', '৩', '৪', '৫', '৬', '৭', '৮', '৯']; return String(numStr).split('').map(c => /\d/.test(c) ? d[parseInt(c)] : c).join(''); } else if (lang === 'ar') { const d = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩']; return String(numStr).split('').map(c => /\d/.test(c) ? d[parseInt(c)] : c).join(''); } return String(numStr); }
        async function fetchWithTimeout(resource, options = {}, timeout = 8000) { const controller = new AbortController(); const id = setTimeout(() => controller.abort(), timeout); try { const response = await fetch(resource, { ...options, signal: controller.signal }); clearTimeout(id); return response; } catch (error) { clearTimeout(id); throw error; } }
        async function determineLanguageAndLocation() { const urlParams = new URLSearchParams(window.location.search); const langParam = urlParams.get('lang'); const savedLang = localStorage.getItem('preferredLang'); let detectedLang = null; let userCountryCode = null; if (langParam && supportedLanguages.includes(langParam)) { detectedLang = langParam; } else if (savedLang && supportedLanguages.includes(savedLang)) { detectedLang = savedLang; } else { try { const response = await fetchWithTimeout('https://ip-api.com/json/?fields=status,message,timezone,countryCode', { cache: 'no-store' }); if (response.ok) { const data = await response.json(); if (data.status === 'success') { if (data.countryCode) { userCountryCode = data.countryCode; if (countryToLangMap[userCountryCode] && supportedLanguages.includes(countryToLangMap[userCountryCode])) { detectedLang = countryToLangMap[userCountryCode];}} if (data.timezone) userTimeZone = data.timezone;}} else console.warn('Failed to get country/timezone from IP API.');} catch (error) { console.error("Error fetching geo data:", error); } if (!detectedLang) { let browserLangFull = (navigator.languages && navigator.languages[0]) || navigator.language || 'bn-BD'; let browserLangShort = browserLangFull.split('-')[0].toLowerCase(); if (supportedLanguages.includes(browserLangShort)) detectedLang = browserLangShort; }} currentLang = detectedLang || 'bn'; userLocale = langToLocaleMap[currentLang] || (currentLang === 'bn' ? 'bn-BD' : 'en-US'); document.documentElement.lang = currentLang; document.body.lang = currentLang; applyTranslations(); }
        async function fetchCorrectTime() { try { const response = await fetchWithTimeout(`https://worldtimeapi.org/api/timezone/${userTimeZone}`,{cache:'no-store'}); if (response.ok) { const data = await response.json(); const serverTime = new Date(data.utc_datetime); const clientTimeAtFetch = new Date(); timeOffset = serverTime.getTime() - clientTimeAtFetch.getTime(); userTimeZone = data.timezone; } else if (userTimeZone !== 'Etc/UTC') { userTimeZone = 'Etc/UTC'; return await fetchCorrectTime(); } else throw new Error("WorldTimeAPI failed even for Etc/UTC"); } catch (error) { console.error("Failed to fetch time:", error); timeOffset = 0; } updateTimeDate(); }
        function initializeDateTimeDisplay() { updateTimeDate(); setInterval(updateTimeDate, 1000); }
        function updateTimeDate() { const correctedNow = new Date(new Date().getTime() + timeOffset); const timeOpts = { hour: 'numeric', minute: '2-digit', second: '2-digit', hour12: true, timeZone: userTimeZone }; let timeStr; try {timeStr = correctedNow.toLocaleTimeString(userLocale, timeOpts);} catch(e){timeStr = correctedNow.toLocaleTimeString(userLocale, {...timeOpts, timeZone:undefined});} if(currentTimeEl)currentTimeEl.textContent = `${getTranslation('timeLabel')}: ${timeStr}`; const dateOpts = { day: 'numeric', month: 'long', year: 'numeric', timeZone: userTimeZone }; let dateStr; try {dateStr = correctedNow.toLocaleDateString(userLocale, dateOpts);} catch(e){dateStr = correctedNow.toLocaleDateString(userLocale, {...dateOpts, timeZone:undefined});} if(currentDateEl)currentDateEl.textContent = `${getTranslation('dateLabel')}: ${dateStr}`; if (currentHijriDateEl && typeof HijriDate !== 'undefined' && HijriDate.JS) { try { const hijri = HijriDate.JS.convert(correctedNow); if (hijri && hijri.getDate) { const day = toNativeNumeral(hijri.getDate(), currentLang); const monthIdx = hijri.getMonth() - 1; const months = hijriMonthsData[currentLang] || hijriMonthsData['en']; if (monthIdx >= 0 && monthIdx < months.length) { const monthName = months[monthIdx]; const year = toNativeNumeral(hijri.getFullYear(), currentLang); currentHijriDateEl.textContent = `${getTranslation('hijriDateLabel')}: ${day} ${monthName}, ${year} ${getTranslation('hijriYearSuffix')}`; } else throw new Error("Invalid Hijri month index."); } else throw new Error("Invalid Hijri object."); } catch (e) { currentHijriDateEl.textContent = getTranslation('hijriDateError'); console.error("Hijri error:", e); } } else if(currentHijriDateEl) { currentHijriDateEl.textContent = getTranslation('hijriNotLoaded'); }}
        function attemptMusicPlay(interactionType="unknown"){if(backgroundMusic&&backgroundMusic.paused){const p=backgroundMusic.play();if(p!==undefined){p.then(()=>{document.body.removeEventListener('click',handleFirstUserInteractionForMedia);document.body.removeEventListener('touchstart',handleFirstUserInteractionForMedia);}).catch(e=>{console.warn(`Music play failed via ${interactionType}:`,e);});}}}
        function handleFirstUserInteractionForMedia(event){if(!musicPlayAttemptedOnInteraction){attemptMusicPlay(`general body ${event.type}`);musicPlayAttemptedOnInteraction=true;}if(eidVideoEl&&eidVideoEl.paused){eidVideoEl.play().catch(e=>console.warn("Video play fail on interaction:",e));}}
        function setLanguage(langCode){if(supportedLanguages.includes(langCode)&¤tLang!==langCode){currentLang=langCode;userLocale=langToLocaleMap[currentLang]||(currentLang==='bn'?'bn-BD':'en-US');localStorage.setItem('preferredLang',currentLang);document.documentElement.lang=currentLang;document.body.lang=currentLang;applyTranslations();updateTimeDate();}}
        window.onload = async function() {
            await determineLanguageAndLocation(); await fetchCorrectTime();
            const params = new URLSearchParams(window.location.search); const nameParam = params.get('name');
            if (nameParam) greetingMessageEl.textContent = getTranslation('greetingMessageFrom', { name: decodeURIComponent(nameParam) }); else greetingMessageEl.textContent = getTranslation('greetingMessage');
            greetingMessageEl.style.animation = 'none'; greetingMessageEl.offsetHeight; greetingMessageEl.style.animation = null;
            if (backgroundMusic) { const p = backgroundMusic.play(); if (p !== undefined) p.catch(e => { if (e.name === 'NotAllowedError') { document.body.addEventListener('click', handleFirstUserInteractionForMedia, { once: true }); document.body.addEventListener('touchstart', handleFirstUserInteractionForMedia, { once: true }); }});}
            if (eidVideoEl) { const p = eidVideoEl.play(); if (p !== undefined) p.catch(e => { if (!musicPlayAttemptedOnInteraction && e.name === 'NotAllowedError') { document.body.addEventListener('click', handleFirstUserInteractionForMedia, { once: true }); document.body.addEventListener('touchstart', handleFirstUserInteractionForMedia, { once: true }); }}); eidVideoEl.onerror = () => console.error("Video load error.");}
            generateButton.disabled = true; userNameInput.addEventListener('input', () => { generateButton.disabled = userNameInput.value.trim() === ""; });
            startFireworks(); animateFireworks(); initializeDateTimeDisplay();
        };
        function showStatusMessage(key,type='info',duration=3000,params={}){clearTimeout(statusTimeout);statusMessageDiv.textContent=getTranslation(key,params);statusMessageDiv.className='';statusMessageDiv.classList.add(type);statusMessageDiv.style.display='block';setTimeout(()=>{statusMessageDiv.style.opacity='1';},10);statusTimeout=setTimeout(()=>{statusMessageDiv.style.opacity='0';setTimeout(()=>{statusMessageDiv.style.display='none';},500);},duration);}
        async function generateAndShareLink(){const name=userNameInput.value.trim();if(name===""){showStatusMessage("statusEnterName","error");return;}attemptMusicPlay("share button");const url=new URL(window.location.href);url.searchParams.set('name',name);const link=url.toString();const shareText=getTranslation('greetingMessageFrom',{name:decodeURIComponent(name)})+` ${getTranslation('pageTitle')}! ${link}`;if(navigator.share){try{await navigator.share({title:getTranslation('pageTitle'),text:shareText,url:link});showStatusMessage('statusShareOptions','success',1000);document.getElementById('generatedLinkContainer').style.display='none';}catch(e){showManualLink(link);showStatusMessage('statusShareError','info',4000);}}else{showManualLink(link);showStatusMessage('statusNoAutoShare','info',4000);}userNameInput.value='';generateButton.disabled=true;}
        function showManualLink(link){document.getElementById('sharableLink').value=link;document.getElementById('generatedLinkContainer').style.display='block';}
        function copyLink(){const input=document.getElementById('sharableLink');input.select();input.setSelectionRange(0,99999);try{navigator.clipboard.writeText(input.value).then(()=>showStatusMessage("statusLinkCopied","success")).catch(e=>{if(document.execCommand('copy'))showStatusMessage("statusLinkCopiedFallback","success");else showStatusMessage("statusCopyError","error",4000);});}catch(e){if(document.execCommand('copy'))showStatusMessage("statusLinkCopiedFallback","success");else showStatusMessage("statusCopyError","error",4000);}}
    </script>
    <script>
    // --- Fireworks Animation (Standard Version) ---
    const canvas = document.getElementById('fireworksCanvas'); const ctx = canvas.getContext('2d'); canvas.width = window.innerWidth; canvas.height = window.innerHeight; let fireworks = []; let particles = []; const fireworkLaunchProbability = 0.025; const maxFireworksAtOnce = 5;
    function random(min, max) { return Math.random() * (max - min) + min; }
    function Firework(startX, startY, targetX, targetY) { this.x = startX; this.y = startY; this.startX = startX; this.startY = startY; this.targetX = targetX; this.targetY = targetY; this.distanceToTarget = Math.sqrt(Math.pow(targetX - startX, 2) + Math.pow(targetY - startY, 2)); this.distanceTraveled = 0; this.trail = []; this.angle = Math.atan2(targetY - startY, targetX - startX); this.speed = random(2, 4); this.acceleration = 1.03 + Math.random() * 0.02; this.brightness = random(50, 80); this.hue = random(0,360); this.color = `hsl(${this.hue}, 100%, ${this.brightness}%)`; this.lineWidth = random(1, 3); }
    Firework.prototype.update = function(index) { this.trail.push({ x: this.x, y: this.y }); if (this.trail.length > 10) this.trail.shift(); this.speed *= this.acceleration; let vx = Math.cos(this.angle) * this.speed; let vy = Math.sin(this.angle) * this.speed; this.distanceTraveled = Math.sqrt(Math.pow(this.x - this.startX, 2) + Math.pow(this.y - this.startY, 2)); if (this.distanceTraveled >= this.distanceToTarget || this.y < this.targetY) { createParticles(this.targetX, this.targetY, this.hue); fireworks.splice(index, 1); } else { this.x += vx; this.y += vy; } };
    Firework.prototype.draw = function() { ctx.beginPath(); if (this.trail.length > 0) ctx.moveTo(this.trail[0].x, this.trail[0].y); else ctx.moveTo(this.x - Math.cos(this.angle) * 10, this.y - Math.sin(this.angle) * 10); ctx.lineTo(this.x, this.y); ctx.strokeStyle = this.color; ctx.lineWidth = this.lineWidth; ctx.stroke(); ctx.beginPath(); ctx.arc(this.x, this.y, this.lineWidth + 1, 0, Math.PI * 2); ctx.fillStyle = this.color.replace(')', ', 0.5)').replace('hsl', 'hsla'); ctx.fill(); for (let i = 0; i < this.trail.length; i++) { let p = this.trail[i]; ctx.beginPath(); ctx.arc(p.x, p.y, this.lineWidth * (i / this.trail.length), 0, Math.PI * 2); ctx.fillStyle = this.color.replace(')', `, ${i / this.trail.length * 0.3})`).replace('hsl', 'hsla'); ctx.fill(); }};
    function Particle(x, y, hue) { this.x = x; this.y = y; this.angle = random(0, Math.PI * 2); this.speed = random(1, 12); this.friction = 0.95 + Math.random() * 0.02; this.gravity = 0.8 + Math.random() * 0.4; this.hue = hue + random(-20, 20); this.brightness = random(50, 85); this.alpha = 1; this.decay = random(0.015, 0.035); this.size = random(1, 4); }
    Particle.prototype.update = function(index) { this.speed *= this.friction; this.x += Math.cos(this.angle) * this.speed; this.y += Math.sin(this.angle) * this.speed + this.gravity; this.alpha -= this.decay; if (this.alpha <= this.decay) particles.splice(index, 1); };
    Particle.prototype.draw = function() { ctx.save(); ctx.globalAlpha = this.alpha; ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = `hsl(${this.hue}, 100%, ${this.brightness}%)`; ctx.fill(); ctx.restore(); };
    function createParticles(x, y, hue) { let count = 100 + Math.floor(random(0, 50)); while (count--) particles.push(new Particle(x, y, hue)); }
    function launchFirework() { if (fireworks.length < maxFireworksAtOnce && Math.random() < fireworkLaunchProbability) { const sx = random(canvas.width*.2,canvas.width*.8); const sy = canvas.height; const tx = random(0,canvas.width); const ty = random(0,canvas.height/2.5); fireworks.push(new Firework(sx,sy,tx,ty)); }}
    function startFireworks() { for(let i=0;i<3+Math.floor(random(0,3));i++){setTimeout(()=>{const sx=random(canvas.width*.2,canvas.width*.8);const sy=canvas.height;const tx=random(0,canvas.width);const ty=random(0,canvas.height/2.5);fireworks.push(new Firework(sx,sy,tx,ty));},i*(200+random(0,200)));}}
    function animateFireworks() { requestAnimationFrame(animateFireworks); ctx.fillStyle = 'rgba(0,0,0,0.1)'; ctx.fillRect(0,0,canvas.width,canvas.height); launchFirework(); fireworks.forEach((f,i) => {f.update(i); f.draw();}); particles.forEach((p,i) => {p.update(i); p.draw();}); }
    window.addEventListener('resize', () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
    </script>
</body>
</html>
